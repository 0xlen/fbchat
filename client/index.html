<html>

<style>
pre{
    white-space: -moz-pre-wrap; /* Mozilla, supported since 1999 */
    white-space: -pre-wrap; /* Opera */
    white-space: -o-pre-wrap; /* Opera */
    white-space: pre-wrap; /* CSS3 - Text module (Candidate Recommendation) http://www.w3.org/TR/css3-text/#white-space */
    word-wrap: break-word; /* IE 5.5+ */
}
</style>
<script src="js/jquery.min.js" type="text/javascript"></script>

<script type="text/javascript">
$(function(){
    function escapeHtml(unsafe) {
        return unsafe
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
    }
    $.getJSON('http://localhost/fbchat/list.php',
        function(list){

            $.each(list ,function(i,user){
                $('ul#list').append('<img src="https://graph.facebook.com/'
                                    + user + '/picture" />');
                $.getJSON('https://graph.facebook.com/' + user ,
                    function(userData){
                        $('ul#list').find('img').eq(i).attr('title',userData.name);
                    }
                )
            })
        }
    )
    $('ul textarea#msg').keypress(
        function(e){
            if (e.which == 13 && !e.shiftKey){
                    $('ul#log div#msgbox').append('<pre>' + escapeHtml( $(this).val() ) + '</pre>');
                    $(this).val('');
                    $('ul#log div#msgbox').scrollTop( $('ul#log div#msgbox').height() + 100 );
            }
        }
    )
})
</script>

<ul id="list">
</ul>

<ul id="log">
    <div id="msgbox" style="height:240px;width:260px;list-style:none;overflow-y:scroll;overflow-x:hidden;">
        <li>xxxx</li>
        <li>xxxa</li>
        <li>xxxb</li>
        <li>xxxc</li>
    </div>
</ul>

<ul>
<textarea style="max-height:30px;height: 20px;min-width:260px;max-width:260px;outline:none;display: block;resize: none;overflow:hidden;" id="msg"></textarea>
</ul>

</html>
